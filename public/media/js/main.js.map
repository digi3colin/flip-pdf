{"version":3,"file":"main.js","names":["value","direct","then","Promise","resolve","f","args","i","arguments","length","apply","e","reject","pact","state","s","v","o","bind","observer","prototype","onFulfilled","onRejected","result","callback","_this","thenable","test","update","body","stage","shouldContinue","updateValue","_resumeAfterTest","_resumeAfterBody","_resumeAfterUpdate","renderPdf","pdf","w","h","showPage","p1","pw","view","scale","ph","book","initBook","grid","debug","coverPage","PIXI","Sprite","from","blobUrl","pages","addChild","setPage","pagesMask","clear","beginFill","drawRect","endFill","p2","mcPage","x","pageWidth","numPages","p","getCanvasBlobURL","canvas","getBlob","blob","URL","createObjectURL","blobURL","width","height","num","getPage","page","Math","min","document","createElement","renderPage","render","querySelector","outputScale","window","devicePixelRatio","viewport","getViewport","context","getContext","floor","transform","renderContext","canvasContext","promise","Vec2","radianToDegree","n","PI","degreeToRadian","rotation","a","b","atan2","y","assign","add","subtract","multiplyScalar","pointSlope","m","magnitude","sqrt","normalize","mag","slope","d","perpendicularSlope","project","normalizedScalarProjection","pointAt","len","easeInOutSine","cos","easeInSine","easeOutSine","sin","FlipBook","pageHeight","pageNumber","contents","sprite","deviceRatio","set","direction","corner","mx","my","getMaskPoints","p3","p4","p5","p6","p3x","np","ap1x","tolerance","ratio","max","maxY","m2","Vec2Debug","graphics","color","size","offsetA","drawCircle","alpha","oa","ob","lineStyle","moveTo","lineTo","htmlStage","getElementById","rect","getBoundingClientRect","console","log","app","Application","antialias","backgroundAlpha","backgroundColor","resolution","appendChild","stageCenter","Container","bg","Graphics","backPages","mask","flipPageMask","flipPage","flipPageContainer","interactive","dot","drawLine","setFlipPageContent","content","isDragging","onDragStart","evt","pt","data","getLocalPosition","start","nextBack","onDragEnd","addChildAt","currentPage","nextPage","on","move","origin","drawPoint","op1","op2","op3","op4","op5","op6","mcx","mcy","oc1","oc2","oc3","drawPolygon","doc","pdfjsLib","getDocument","toBlob","innerWidth","innerHeight"],"sources":["../../../public_source/media/js/main.js"],"sourcesContent":["const Vec2 = {\n  radianToDegree: (n) => n * (180 /Math.PI),\n  degreeToRadian: (n) => n * (Math.PI/180),\n  rotation: (a, b) => Math.atan2(b.y-a.y, b.x-a.x),\n  assign : (a, b) => {a.x = b.x; a.y=b.y},\n  add : (a,b) => ({ x: a.x + b.x, y: a.y + b.y }),\n  subtract: (a,b) => ({ x: a.x - b.x, y: a.y - b.y }),\n  multiplyScalar: (a, s) => ({ x: a.x * s, y: a.y * s}),\n  pointSlope: (m, a, x=null, y=null) => ({x: (x !== null) ? x : (y - a.y) / m + a.x, y: (y !== null) ? y : m * (x - a.x) + a.y}),\n  magnitude: a => Math.sqrt((a.x * a.x) + (a.y * a.y)),\n  normalize: a => {\n    const mag = Vec2.magnitude(a);\n    return {x: a.x / mag, y: a.y / mag}\n  },\n  slope: (a, o= {x:0, y:0}) => {\n    const d = Vec2.subtract(a, o);\n    return d.y / d.x;\n  },\n  perpendicularSlope(a, o = {x:0, y:0}){\n    const d = Vec2.subtract(a, o);\n    return - d.x / d.y;\n  },\n  project: (a,b) => {\n    const normalizedScalarProjection = ((a.x * b.x) + (a.y * b.y)) / ((b.x * b.x) + (b.y * b.y));\n    return{\n      x: b.x * normalizedScalarProjection,\n      y: b.y * normalizedScalarProjection\n    }\n  },\n\n  pointAt: (a, len=1, o={x:0, y:0}) => {\n    const d = Vec2.subtract(a, o);\n    const n = Vec2.normalize(d);\n    const p2 = Vec2.multiplyScalar(n, len);\n    return Vec2.add(p2, o);\n  },\n  easeInOutSine: x => -(Math.cos(Math.PI * x) - 1) * .5,\n  easeInSine:    x => 1 - Math.cos((x * Math.PI) * .5),\n  easeOutSine:   x => Math.sin((x * Math.PI) * .5)\n\n}\nclass FlipBook {\n  contents = [];\n  pages = [null];\n  direction = {x:0,y:0};\n  corner = {x:0,y:0};\n  page = 1;\n\n  constructor(pageWidth=300, pageHeight=300) {\n    this.pageWidth = pageWidth;\n    this.pageHeight = pageHeight;\n  }\n\n  setPageContent(pageNumber, blob){\n    contents[pageNumber] = blob;\n  }\n\n  setPage(num, sprite){\n    const deviceRatio = 1 / (window.devicePixelRatio || 1);\n    sprite.scale.set(deviceRatio, deviceRatio);\n    this.pages[num] = sprite;\n  }\n\n  start(p){\n    //find hover zone\n    this.direction.x = (p.x < 0) ? -1 : 1;\n    this.direction.y = (p.y < 0) ? -1 : 1;\n\n    this.corner = {\n      x: this.pageWidth * this.direction.x,\n      y: this.pageHeight * 0.5 * this.direction.y\n    };\n  }\n\n  move(p){\n    const p1 = Vec2.subtract(p, this.corner);\n    const mx = this.pageWidth * -this.direction.x;\n    const my = this.pageHeight * -this.direction.y;\n\n    const {p2, p3, p4, p5, p6} = FlipBook.getMaskPoints(p1, my);\n\n    //limit p3, p5\n    const p3x = (p3.x * -this.direction.x);\n    if(p3x > this.pageWidth || p3x < 0){\n      p3.x = mx;\n\n      const np = FlipBook.getMaskPoints(Vec2.pointAt(p1, this.pageWidth, p3), my);\n      Vec2.assign(p1, np.p1);\n      Vec2.assign(p2, np.p2);\n      Vec2.assign(p3, np.p3);\n      Vec2.assign(p4, np.p4);\n      Vec2.assign(p5, np.p5);\n      Vec2.assign(p6, np.p6);\n    }\n\n    if((p5.x * -this.direction.x) > this.pageWidth){\n      p5.x = mx;\n\n      Vec2.assign(p6, Vec2.pointAt(p6, this.pageWidth, p5));\n      Vec2.assign(p1, Vec2.pointAt(Vec2.pointSlope(Vec2.perpendicularSlope(p6, p5), p6, 0, null), this.pageHeight, p6));\n\n      const ap1x = (p1.x * -this.direction.x);\n      const tolerance = 25;\n      if(ap1x < tolerance ){\n        const ratio = Math.max(ap1x / tolerance, 0);\n        p1.y = p1.y * Vec2.easeOutSine(ratio);\n      }\n\n      const np = FlipBook.getMaskPoints(p1, my);\n      Vec2.assign(p1, np.p1);\n      Vec2.assign(p2, np.p2);\n      Vec2.assign(p3, np.p3);\n      Vec2.assign(p4, np.p4);\n      Vec2.assign(p5, np.p5);\n      Vec2.assign(p6, np.p6);\n    }\n\n    return {p1, p2, p3, p4, p5, p6}\n  }\n\n  static getMaskPoints(p1, maxY) {\n    const p2 = Vec2.multiplyScalar(p1, .5);\n\n    const m2 = Vec2.perpendicularSlope(p2);\n    const p3 = Vec2.pointSlope(m2, p2, null, 0);\n    const p4 = Vec2.pointSlope(m2, p2, 0, null);\n    const p5 = Vec2.pointSlope(m2, p2, null, maxY);\n\n    const p6 = Vec2.add(Vec2.project(Vec2.subtract(p5, p1), Vec2.subtract(p4, p1)), p1);\n    return { p1, p2, p3, p4, p5, p6 }\n  }\n}\n\n//load pdf;\n\nasync function renderPage(page, canvas, scale){\n  const outputScale = window.devicePixelRatio || 1;\n\n  const viewport = page.getViewport({scale: scale});\n  const context = canvas.getContext('2d');\n  canvas.width = Math.floor(viewport.width * outputScale);\n  canvas.height = Math.floor(viewport.height * outputScale);\n\n  const transform = outputScale !== 1\n    ? [outputScale, 0, 0, outputScale, 0, 0]\n    : null;\n\n  const renderContext = {\n    canvasContext: context,\n    transform: transform,\n    viewport: viewport\n  };\n  await page.render(renderContext).promise;\n}\n\n//visualise\nclass Vec2Debug{\n  static drawPoint(graphics, color, size, a, o={x:0, y:0}){\n    const offsetA = Vec2.add(o, a);\n\n    graphics\n      .beginFill(color)\n      .drawCircle(offsetA.x, offsetA.y, size)\n      .endFill();\n\n    return offsetA;\n  }\n\n  static drawLine(graphics, color, width, alpha, a, b, o = {x:0, y:0}){\n    const oa = Vec2.add(o, a);\n    const ob = Vec2.add(o, b);\n\n    graphics\n      .lineStyle({ width, color, alpha })\n      .moveTo(oa.x, oa.y)\n      .lineTo(ob.x, ob.y)\n      .endFill();\n\n    return {oa, ob}\n  }\n}\n\n//prepare stage\nconst {bg, pages, pagesMask, flipPage, flipPageContainer, flipPageMask, backPages, grid, debug} = (()=>{\n  const htmlStage = document.getElementById('stage');\n  const rect = htmlStage.getBoundingClientRect();\n  console.log(rect);\n  const app = new PIXI.Application({ width: rect.width, height: rect.height , antialias: false, backgroundAlpha: 1, backgroundColor: 0xEEEEEE, resolution: 2 });\n  htmlStage.appendChild(app.view);\n\n  const stageCenter = new PIXI.Container();\n  app.stage.addChild(stageCenter);\n  stageCenter.x = rect.width * .5;\n  stageCenter.y = rect.height * .5;\n\n  const bg = new PIXI.Graphics();\n  bg.beginFill(0x222222);\n  bg.drawRect(-rect.width * .5, -rect.height * .5, rect.width, rect.height);\n  stageCenter.addChild(bg);\n\n  const pagesMask = new PIXI.Graphics();\n  stageCenter.addChild(pagesMask);\n\n  const backPages = new PIXI.Container();\n  stageCenter.addChild(backPages)\n\n  const pages = new PIXI.Container();\n  pages.mask = pagesMask\n  stageCenter.addChild(pages)\n\n  const flipPageMask = new PIXI.Graphics();\n  stageCenter.addChild(flipPageMask);\n\n  const flipPage = new PIXI.Container();\n  flipPage.mask = flipPageMask;\n  stageCenter.addChild(flipPage);\n\n  const flipPageContainer = new PIXI.Container();\n  flipPage.addChild(flipPageContainer);\n\n  const grid = new PIXI.Graphics();\n  grid.interactive = true;\n  stageCenter.addChild(grid);\n\n  const debug = new PIXI.Graphics();\n  stageCenter.addChild(debug);\n\n  const dot = new PIXI.Graphics();\n  stageCenter.addChild(dot);\n\n  Vec2Debug.drawLine(dot, 0xFFFFFF, 0.5, 0.3, {x:0, y:-stageCenter.y}, {x:0, y: rect.height});\n  Vec2Debug.drawLine(dot, 0xFFFFFF, 0.5, 0.3, {x:-stageCenter.x, y:0}, {x:rect.width, y:0});\n\n  return {bg, pages, pagesMask, flipPage, flipPageContainer, flipPageMask, backPages, grid, debug};\n})();\n\nfunction setFlipPageContent(book){\n  const content = (book.direction.x > 0)? book.pages[book.page+2] : book.pages[book.page-1];\n  content.x = 0;\n  content.y = 0;\n  flipPageContainer.x = (book.direction.x < 0 )? -book.pageWidth : 0;\n  flipPageContainer.y = (book.direction.y > 0 )? -book.pageHeight : 0;\n  flipPageContainer.addChild(content);\n}\n\nfunction initBook(width, height, grid, debug){\n  const book = new FlipBook(width, height);\n  window.book = book;\n\n  let isDragging = false;\n  grid.lineStyle({ width: 1, color: 0xFFFFFF, alpha: 0.3 })\n  grid.beginFill(0x000000, 0.01);\n  grid.drawRect(-book.pageWidth, -book.pageHeight * 0.5, book.pageWidth * 2, book.pageHeight);\n\n  pages.x = -width;\n  pages.y = -height * 0.5;\n  backPages.x = pages.x;\n  backPages.y = pages.y;\n\n  function onDragStart(evt){\n    const pt = evt.data.getLocalPosition(bg);\n    book.start(pt);\n\n    if(book.direction.x > 0){\n      const nextBack = book.pages[book.page + 3];\n      if(!nextBack)return;\n      nextBack.x = book.pageWidth;\n      backPages.addChild(nextBack);\n    }else{\n      const nextBack = book.pages[book.page - 2];\n      if(!nextBack)return;\n      nextBack.x = 0;\n      backPages.addChild(nextBack);\n    }\n\n    isDragging = true;\n    setFlipPageContent(book);\n  }\n\n  function onDragEnd(){\n    if(isDragging === false)return;\n\n    isDragging = false;\n    if(book.direction.x > 0){\n      //flip forward\n      //send current page to back pages;\n      backPages.addChild(book.pages[book.page]);\n\n      //push flip page to pages;\n      book.page += 2;\n    }else{\n      //flip back\n      backPages.addChildAt(book.pages[book.page]);\n      book.page -= 2;\n    }\n\n    const currentPage = book.pages[book.page];\n    if(currentPage)pages.addChild(currentPage);\n    const nextPage = book.pages[book.page+1];\n    if(nextPage){\n      pages.addChild(nextPage);\n      nextPage.x = book.pageWidth;\n    }\n\n    flipPageMask.clear();\n    pagesMask.clear();\n    debug.clear();\n    pagesMask.beginFill(0xFF0000, 1);\n    pagesMask.drawRect(-book.pageWidth, -book.pageHeight * .5, book.pageWidth *2, book.pageHeight)\n    pagesMask.endFill();\n  }\n\n  grid.on('pointerdown', evt => onDragStart(evt) )\n    .on('pointerup', () => onDragEnd())\n    .on('pointerupoutside', () => onDragEnd())\n\n  grid.on('pointermove', (evt)=>{\n    if(!isDragging)return;\n    debug.clear();\n    pagesMask.clear();\n\n    flipPageMask.clear();\n\n    const pt = evt.data.getLocalPosition(bg);\n    const {p1, p2, p3, p4, p5, p6} = book.move(pt);\n    const origin = book.corner;\n\n    Vec2Debug.drawPoint(debug, 0xFFFFFF, 3, origin);\n    const op1 = Vec2Debug.drawPoint(debug, 0xFF0000, 2, p1, origin);\n    const op2 = Vec2Debug.drawPoint(debug, 0xFFFF00, 2, p2, origin);\n    const op3 = Vec2Debug.drawPoint(debug, 0x00FF77, 2, p3, origin);\n    const op4 = Vec2Debug.drawPoint(debug, 0xFF7700, 2, p4, origin);\n    const op5 = Vec2Debug.drawPoint(debug, 0xFF00FF, 2, p5, origin);\n    const op6 = Vec2Debug.drawPoint(debug, 0xFF7700, 2, p6, origin);\n\n    const mcx = (book.pageWidth * 2) * -book.direction.x;\n    const mcy = book.pageHeight * -book.direction.y;\n    const oc1 = Vec2.add({x: mcx, y: 0}, origin);\n    const oc2 = Vec2.add({x: mcx , y: mcy}, origin);\n    const oc3 = Vec2.add({x: 0, y: mcy}, origin);\n\n    flipPage.rotation = Vec2.rotation(op1, op3) + ((book.direction.x > 0) ? 0 : Vec2.degreeToRadian(180));\n    flipPage.x = op1.x;\n    flipPage.y = op1.y;\n\n    flipPageMask\n      .beginFill(0xFF0000, 1)\n      .drawPolygon((origin.x < 0 && p5.x < 0 || origin.x > 0 && p5.x > 0) ? [op1, op4, op3] : [op1, op6, op5, op3])\n      .endFill();\n\n    pagesMask\n      .beginFill(0xFF0000, 1)\n      .drawPolygon((origin.x < 0 && p5.x < 0 || origin.x > 0 && p5.x > 0) ? [oc1, oc2, oc3, op4, op3] : [oc1, oc2, op5, op3])\n      .endFill();\n\n    debug\n      .beginFill(0xFFFFFF, 0.2)\n      //    .drawPolygon([pt, oe1, oe2])\n      .drawPolygon((origin.x < 0 && p5.x < 0 || origin.x > 0 && p5.x > 0) ? [op1, op4, op3] : [op1, op6, op5, op3])\n      .endFill();\n\n    //line from p1 to origin\n    Vec2Debug.drawLine(debug, 0xFFFFFF, 1, 0.1, p1, {x:0, y:0}, origin);\n    Vec2Debug.drawLine(debug, 0xFFFFFF, 1, 0.1, p2, p4, origin);\n  })\n\n  return book;\n}\n\n\nconst doc = pdfjsLib.getDocument('/media/pdf/test.pdf');\nasync function render(pdf, book){\n  for( let i =1; i<= pdf.numPages; i++) {\n    const page = await pdf.getPage(i);\n    const scale = book.pageWidth / page.view[2];\n    const canvas = document.querySelector(`#page-${i} canvas`);\n    await renderPage(page, canvas, scale);\n  }\n}\n\nfunction getBlob(canvas){\n  return new Promise((resolve, reject) =>{\n    try{\n      canvas.toBlob((blob)=>{\n        resolve(blob);\n      })\n    }catch (e){\n      reject(e);\n    }\n  })\n}\n\nasync function showPage(pdf, width, height, num){\n  const page =  await pdf.getPage(num);\n  const scale = Math.min(width / page.view[2], height / page.view[3]);\n  const canvas = document.createElement('canvas');\n  await renderPage(page, canvas, scale);\n\n  const blob = await getBlob(canvas);\n  const blobUrl = await URL.createObjectURL(blob);\n\n  return {\n    view: page.view,\n    scale,\n    blob,\n    blobUrl,\n  };\n}\n\nasync function getCanvasBlobURL(canvas){\n  const blob = await getBlob(canvas);\n  const blobURL = await URL.createObjectURL(blob);\n  return { blob, blobURL }\n}\n\nasync function renderPdf(pdf, w, h){\n  const p1 = await showPage(pdf, w, h ,1);\n  const pw = p1.view[2] * p1.scale;\n  const ph = p1.view[3] * p1.scale;\n  const book = initBook(pw, ph, grid, debug);\n\n  const coverPage = PIXI.Sprite.from(p1.blobUrl);\n  pages.addChild(coverPage);\n  book.setPage(1, coverPage);\n\n  pagesMask.clear();\n  pagesMask.beginFill(0xFF0000, 1);\n  pagesMask.drawRect(-pw, -ph * .5, pw *2, ph)\n  pagesMask.endFill();\n\n  const p2 = await showPage(pdf, w, h ,2);\n  const mcPage = PIXI.Sprite.from(p2.blobUrl);\n  mcPage.x = book.pageWidth;\n  pages.addChild(mcPage);\n  book.setPage(2, mcPage);\n\n  for(let i = 3; i <= pdf.numPages; i++){\n    const p = await showPage(pdf, w, h ,i);\n    book.setPage(i, PIXI.Sprite.from(p.blobUrl));\n  }\n}\n\ndoc.promise.then(pdf => {\n  //suggest width\n  const w = window.innerWidth * 0.5 * 0.8;\n  const h = window.innerHeight * 0.8;\n  window.pdf = pdf;\n  renderPdf(pdf, w, h).then(()=>{});\n});"],"mappings":";;AAgmBO,kBAAkB,CACxB;;AAlgBM,uBAAuBA,KAAvB,EAA8BC,MAA9B,EAAsC;EAC5C,IAAI,CAACA,MAAL,EAAa;IACZ,OAAOD,KAAK,IAAIA,KAAK,CAACE,IAAf,GAAsBF,KAAK,CAACE,IAAN,QAAtB,GAA2CC,OAAO,CAACC,OAAR,EAAlD;EACA;AACD;;AA7BM,gBAAgBC,CAAhB,EAAmB;EACzB,OAAO,YAAW;IACjB,KAAK,IAAIC,IAAI,GAAG,EAAX,EAAeC,CAAC,GAAG,CAAxB,EAA2BA,CAAC,GAAGC,SAAS,CAACC,MAAzC,EAAiDF,CAAC,EAAlD,EAAsD;MACrDD,IAAI,CAACC,CAAD,CAAJ,GAAUC,SAAS,CAACD,CAAD,CAAnB;IACA;;IACD,IAAI;MACH,OAAOJ,OAAO,CAACC,OAAR,CAAgBC,CAAC,CAACK,KAAF,CAAQ,IAAR,EAAcJ,IAAd,CAAhB,CAAP;IACA,CAFD,CAEE,OAAMK,CAAN,EAAS;MACV,OAAOR,OAAO,CAACS,MAAR,CAAeD,CAAf,CAAP;IACA;EACD,CATD;AAUA;;AAGM,gBAAgBX,KAAhB,EAAuBE,IAAvB,EAA6BD,MAA7B,EAAqC;EAC3C,IAAIA,MAAJ,EAAY;IACX,OAAOC,IAAI,GAAGA,IAAI,CAACF,KAAD,CAAP,GAAiBA,KAA5B;EACA;;EACD,IAAI,CAACA,KAAD,IAAU,CAACA,KAAK,CAACE,IAArB,EAA2B;IAC1BF,KAAK,GAAGG,OAAO,CAACC,OAAR,CAAgBJ,KAAhB,CAAR;EACA;;EACD,OAAOE,IAAI,GAAGF,KAAK,CAACE,IAAN,CAAWA,IAAX,CAAH,GAAsBF,KAAjC;AACA;;AArDM,iBAAiBa,IAAjB,EAAuBC,KAAvB,EAA8Bd,KAA9B,EAAqC;EAC3C,IAAI,CAACa,IAAI,CAACE,CAAV,EAAa;IACZ,IAAIf,KAAK,iBAAT,EAA4B;MAC3B,IAAIA,KAAK,CAACe,CAAV,EAAa;QACZ,IAAID,KAAK,GAAG,CAAZ,EAAe;UACdA,KAAK,GAAGd,KAAK,CAACe,CAAd;QACA;;QACDf,KAAK,GAAGA,KAAK,CAACgB,CAAd;MACA,CALD,MAKO;QACNhB,KAAK,CAACiB,CAAN,GAAU,QAAQC,IAAR,CAAa,IAAb,EAAmBL,IAAnB,EAAyBC,KAAzB,CAAV;QACA;MACA;IACD;;IACD,IAAId,KAAK,IAAIA,KAAK,CAACE,IAAnB,EAAyB;MACxBF,KAAK,CAACE,IAAN,CAAW,QAAQgB,IAAR,CAAa,IAAb,EAAmBL,IAAnB,EAAyBC,KAAzB,CAAX,EAA4C,QAAQI,IAAR,CAAa,IAAb,EAAmBL,IAAnB,EAAyB,CAAzB,CAA5C;MACA;IACA;;IACDA,IAAI,CAACE,CAAL,GAASD,KAAT;IACAD,IAAI,CAACG,CAAL,GAAShB,KAAT;IACA,IAAMmB,QAAQ,GAAGN,IAAI,CAACI,CAAtB;;IACA,IAAIE,QAAJ,EAAc;MACbA,QAAQ,CAACN,IAAD,CAAR;IACA;EACD;AACD;;AA9DM,IAAM,QAAQ,aAAc,YAAW;EAC7C,iBAAiB,CAAE;;EACnB,MAAMO,SAAN,CAAgBlB,IAAhB,GAAuB,UAASmB,WAAT,EAAsBC,UAAtB,EAAkC;IACxD,IAAMC,MAAM,GAAG,WAAf;IACA,IAAMT,KAAK,GAAG,KAAKC,CAAnB;;IACA,IAAID,KAAJ,EAAW;MACV,IAAMU,QAAQ,GAAGV,KAAK,GAAG,CAAR,GAAYO,WAAZ,GAA0BC,UAA3C;;MACA,IAAIE,QAAJ,EAAc;QACb,IAAI;UACH,QAAQD,MAAR,EAAgB,CAAhB,EAAmBC,QAAQ,CAAC,KAAKR,CAAN,CAA3B;QACA,CAFD,CAEE,OAAOL,CAAP,EAAU;UACX,QAAQY,MAAR,EAAgB,CAAhB,EAAmBZ,CAAnB;QACA;;QACD,OAAOY,MAAP;MACA,CAPD,MAOO;QACN,OAAO,IAAP;MACA;IACD;;IACD,KAAKN,CAAL,GAAS,UAASQ,KAAT,EAAgB;MACxB,IAAI;QACH,IAAMzB,KAAK,GAAGyB,KAAK,CAACT,CAApB;;QACA,IAAIS,KAAK,CAACV,CAAN,GAAU,CAAd,EAAiB;UAChB,QAAQQ,MAAR,EAAgB,CAAhB,EAAmBF,WAAW,GAAGA,WAAW,CAACrB,KAAD,CAAd,GAAwBA,KAAtD;QACA,CAFD,MAEO,IAAIsB,UAAJ,EAAgB;UACtB,QAAQC,MAAR,EAAgB,CAAhB,EAAmBD,UAAU,CAACtB,KAAD,CAA7B;QACA,CAFM,MAEA;UACN,QAAQuB,MAAR,EAAgB,CAAhB,EAAmBvB,KAAnB;QACA;MACD,CATD,CASE,OAAOW,CAAP,EAAU;QACX,QAAQY,MAAR,EAAgB,CAAhB,EAAmBZ,CAAnB;MACA;IACD,CAbD;;IAcA,OAAOY,MAAP;EACA,CA/BD;;EAgCA;AACA,CAnCiC,EAA3B;;AAgEA,wBAAwBG,QAAxB,EAAkC;EACxC,OAAOA,QAAQ,iBAAR,IAA6BA,QAAQ,CAACX,CAAT,GAAa,CAAjD;AACA;;AA4LM,cAAcY,IAAd,EAAoBC,MAApB,EAA4BC,IAA5B,EAAkC;EACxC,IAAIC,KAAJ;;EACA,SAAS;IACR,IAAIC,cAAc,GAAGJ,IAAI,EAAzB;;IACA,IAAI,eAAeI,cAAf,CAAJ,EAAoC;MACnCA,cAAc,GAAGA,cAAc,CAACf,CAAhC;IACA;;IACD,IAAI,CAACe,cAAL,EAAqB;MACpB,OAAOR,MAAP;IACA;;IACD,IAAIQ,cAAc,CAAC7B,IAAnB,EAAyB;MACxB4B,KAAK,GAAG,CAAR;MACA;IACA;;IACD,IAAIP,MAAM,GAAGM,IAAI,EAAjB;;IACA,IAAIN,MAAM,IAAIA,MAAM,CAACrB,IAArB,EAA2B;MAC1B,IAAI,eAAeqB,MAAf,CAAJ,EAA4B;QAC3BA,MAAM,GAAGA,MAAM,CAACR,CAAhB;MACA,CAFD,MAEO;QACNe,KAAK,GAAG,CAAR;QACA;MACA;IACD;;IACD,IAAIF,MAAJ,EAAY;MACX,IAAII,WAAW,GAAGJ,MAAM,EAAxB;;MACA,IAAII,WAAW,IAAIA,WAAW,CAAC9B,IAA3B,IAAmC,CAAC,eAAe8B,WAAf,CAAxC,EAAqE;QACpEF,KAAK,GAAG,CAAR;QACA;MACA;IACD;EACD;;EACD,IAAIjB,IAAI,GAAG,WAAX;;EACA,IAAID,MAAM,GAAG,QAAQM,IAAR,CAAa,IAAb,EAAmBL,IAAnB,EAAyB,CAAzB,CAAb;;EACA,CAACiB,KAAK,KAAK,CAAV,GAAcC,cAAc,CAAC7B,IAAf,CAAoB+B,gBAApB,CAAd,GAAsDH,KAAK,KAAK,CAAV,GAAcP,MAAM,CAACrB,IAAP,CAAYgC,gBAAZ,CAAd,GAA8CF,WAAW,CAAC9B,IAAZ,CAAiBiC,kBAAjB,CAArG,EAA2IjC,IAA3I,CAAgJ,KAAK,CAArJ,EAAwJU,MAAxJ;EACA,OAAOC,IAAP;;EACA,SAASqB,gBAAT,CAA0BlC,KAA1B,EAAiC;IAChCuB,MAAM,GAAGvB,KAAT;;IACA,GAAG;MACF,IAAI4B,MAAJ,EAAY;QACXI,WAAW,GAAGJ,MAAM,EAApB;;QACA,IAAII,WAAW,IAAIA,WAAW,CAAC9B,IAA3B,IAAmC,CAAC,eAAe8B,WAAf,CAAxC,EAAqE;UACpEA,WAAW,CAAC9B,IAAZ,CAAiBiC,kBAAjB,EAAqCjC,IAArC,CAA0C,KAAK,CAA/C,EAAkDU,MAAlD;UACA;QACA;MACD;;MACDmB,cAAc,GAAGJ,IAAI,EAArB;;MACA,IAAI,CAACI,cAAD,IAAoB,eAAeA,cAAf,KAAkC,CAACA,cAAc,CAACf,CAA1E,EAA8E;QAC7E,QAAQH,IAAR,EAAc,CAAd,EAAiBU,MAAjB;;QACA;MACA;;MACD,IAAIQ,cAAc,CAAC7B,IAAnB,EAAyB;QACxB6B,cAAc,CAAC7B,IAAf,CAAoB+B,gBAApB,EAAsC/B,IAAtC,CAA2C,KAAK,CAAhD,EAAmDU,MAAnD;QACA;MACA;;MACDW,MAAM,GAAGM,IAAI,EAAb;;MACA,IAAI,eAAeN,MAAf,CAAJ,EAA4B;QAC3BA,MAAM,GAAGA,MAAM,CAACP,CAAhB;MACA;IACD,CArBD,QAqBS,CAACO,MAAD,IAAW,CAACA,MAAM,CAACrB,IArB5B;;IAsBAqB,MAAM,CAACrB,IAAP,CAAYgC,gBAAZ,EAA8BhC,IAA9B,CAAmC,KAAK,CAAxC,EAA2CU,MAA3C;EACA;;EACD,SAASqB,gBAAT,CAA0BF,cAA1B,EAA0C;IACzC,IAAIA,cAAJ,EAAoB;MACnBR,MAAM,GAAGM,IAAI,EAAb;;MACA,IAAIN,MAAM,IAAIA,MAAM,CAACrB,IAArB,EAA2B;QAC1BqB,MAAM,CAACrB,IAAP,CAAYgC,gBAAZ,EAA8BhC,IAA9B,CAAmC,KAAK,CAAxC,EAA2CU,MAA3C;MACA,CAFD,MAEO;QACNsB,gBAAgB,CAACX,MAAD,CAAhB;MACA;IACD,CAPD,MAOO;MACN,QAAQV,IAAR,EAAc,CAAd,EAAiBU,MAAjB;IACA;EACD;;EACD,SAASY,kBAAT,GAA8B;IAC7B,IAAIJ,cAAc,GAAGJ,IAAI,EAAzB,EAA6B;MAC5B,IAAII,cAAc,CAAC7B,IAAnB,EAAyB;QACxB6B,cAAc,CAAC7B,IAAf,CAAoB+B,gBAApB,EAAsC/B,IAAtC,CAA2C,KAAK,CAAhD,EAAmDU,MAAnD;MACA,CAFD,MAEO;QACNqB,gBAAgB,CAACF,cAAD,CAAhB;MACA;IACD,CAND,MAMO;MACN,QAAQlB,IAAR,EAAc,CAAd,EAAiBU,MAAjB;IACA;EACD;AACD;;AAxOM,0BAA0BvB,KAA1B,EAAiC;EACvC,IAAIA,KAAK,IAAIA,KAAK,CAACE,IAAnB,EAAyB;IACxB,OAAOF,KAAK,CAACE,IAAN,QAAP;EACA;AACD;;;;;;;;;;IAgTckC,S,YAAAA,S,CAAUC,G,EAAKC,C,EAAGC,C,EAAE;EAAA,cAChBC,QAAQ,CAACH,GAAD,EAAMC,CAAN,EAASC,CAAT,EAAY,CAAZ,CADQ,YAC3BE,EAD2B;IAEjC,IAAMC,EAAE,GAAGD,EAAE,CAACE,IAAH,CAAQ,CAAR,IAAaF,EAAE,CAACG,KAA3B;IACA,IAAMC,EAAE,GAAGJ,EAAE,CAACE,IAAH,CAAQ,CAAR,IAAaF,EAAE,CAACG,KAA3B;IACA,IAAME,IAAI,GAAGC,QAAQ,CAACL,EAAD,EAAKG,EAAL,EAASG,IAAT,EAAeC,KAAf,CAArB;IAEA,IAAMC,SAAS,GAAGC,IAAI,CAACC,MAAL,CAAYC,IAAZ,CAAiBZ,EAAE,CAACa,OAApB,CAAlB;IACAC,KAAK,CAACC,QAAN,CAAeN,SAAf;IACAJ,IAAI,CAACW,OAAL,CAAa,CAAb,EAAgBP,SAAhB;IAEAQ,SAAS,CAACC,KAAV;IACAD,SAAS,CAACE,SAAV,CAAoB,QAApB,EAA8B,CAA9B;IACAF,SAAS,CAACG,QAAV,CAAmB,CAACnB,EAApB,EAAwB,CAACG,EAAD,GAAM,EAA9B,EAAkCH,EAAE,GAAE,CAAtC,EAAyCG,EAAzC;IACAa,SAAS,CAACI,OAAV;IAbiC,cAehBtB,QAAQ,CAACH,GAAD,EAAMC,CAAN,EAASC,CAAT,EAAY,CAAZ,CAfQ,YAe3BwB,EAf2B;MAgBjC,IAAMC,MAAM,GAAGb,IAAI,CAACC,MAAL,CAAYC,IAAZ,CAAiBU,EAAE,CAACT,OAApB,CAAf;MACAU,MAAM,CAACC,CAAP,GAAWnB,IAAI,CAACoB,SAAhB;MACAX,KAAK,CAACC,QAAN,CAAeQ,MAAf;MACAlB,IAAI,CAACW,OAAL,CAAa,CAAb,EAAgBO,MAAhB;MAEI,IAAIzD,CAAC,GAAG,CAAR;MArB6B;QAAA,OAqBlBA,CAAC,IAAI8B,GAAG,CAAC8B,QArBS;MAAA;QAAA,OAqBC5D,CAAC,EArBF;MAAA,eAqBK;QAAA,cACpBiC,QAAQ,CAACH,GAAD,EAAMC,CAAN,EAASC,CAAT,EAAYhC,CAAZ,CADY,YAC9B6D,CAD8B;UAEpCtB,IAAI,CAACW,OAAL,CAAalD,CAAb,EAAgB4C,IAAI,CAACC,MAAL,CAAYC,IAAZ,CAAiBe,CAAC,CAACd,OAAnB,CAAhB;QAFoC;MAGrC,CAxBgC;IAAA;EAAA;AAyBlC,C;;IA/Bce,gB,oBAAiBC,M,EAAO;EAAA,cAClBC,OAAO,CAACD,MAAD,CADW,YAC/BE,IAD+B;IAAA,cAEfC,GAAG,CAACC,eAAJ,CAAoBF,IAApB,CAFe,YAE/BG,OAF+B;MAGrC,OAAO;QAAEH,IAAI,EAAJA,IAAF;QAAQG,OAAO,EAAPA;MAAR,CAAP;IAHqC;EAAA;AAItC,C;;IArBcnC,Q,oBAASH,G,EAAKuC,K,EAAOC,M,EAAQC,G,EAAI;EAAA,cAC1BzC,GAAG,CAAC0C,OAAJ,CAAYD,GAAZ,CAD0B,YACxCE,IADwC;IAE9C,IAAMpC,KAAK,GAAGqC,IAAI,CAACC,GAAL,CAASN,KAAK,GAAGI,IAAI,CAACrC,IAAL,CAAU,CAAV,CAAjB,EAA+BkC,MAAM,GAAGG,IAAI,CAACrC,IAAL,CAAU,CAAV,CAAxC,CAAd;IACA,IAAM2B,MAAM,GAAGa,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;IAH8C,cAIxCC,UAAU,CAACL,IAAD,EAAOV,MAAP,EAAe1B,KAAf,CAJ8B;MAAA,cAM3B2B,OAAO,CAACD,MAAD,CANoB,YAMxCE,IANwC;QAAA,cAOxBC,GAAG,CAACC,eAAJ,CAAoBF,IAApB,CAPwB,YAOxClB,OAPwC;UAS9C,OAAO;YACLX,IAAI,EAAEqC,IAAI,CAACrC,IADN;YAELC,KAAK,EAALA,KAFK;YAGL4B,IAAI,EAAJA,IAHK;YAILlB,OAAO,EAAPA;UAJK,CAAP;QAT8C;MAAA;IAAA;EAAA;AAe/C,C;;IApCcgC,M,oBAAOjD,G,EAAKS,I,EAAK;EACzB,IAAIvC,CAAC,GAAE,CAAP;EADyB;IAAA,OACfA,CAAC,IAAG8B,GAAG,CAAC8B,QADO;EAAA;IAAA,OACG5D,CAAC,EADJ;EAAA,eACQ;IAAA,cACjB8B,GAAG,CAAC0C,OAAJ,CAAYxE,CAAZ,CADiB,YAC9ByE,IAD8B;MAEpC,IAAMpC,KAAK,GAAGE,IAAI,CAACoB,SAAL,GAAiBc,IAAI,CAACrC,IAAL,CAAU,CAAV,CAA/B;MACA,IAAM2B,MAAM,GAAGa,QAAQ,CAACI,aAAT,iBAAgChF,CAAhC,aAAf;MAHoC,qBAI9B8E,UAAU,CAACL,IAAD,EAAOV,MAAP,EAAe1B,KAAf,CAJoB;IAAA;EAKrC,CAN6B;AAO/B,C;;AArPD;IAEeyC,U,oBAAWL,I,EAAMV,M,EAAQ1B,K,EAAM;EAC5C,IAAM4C,WAAW,GAAGC,MAAM,CAACC,gBAAP,IAA2B,CAA/C;EAEA,IAAMC,QAAQ,GAAGX,IAAI,CAACY,WAAL,CAAiB;IAAChD,KAAK,EAAEA;EAAR,CAAjB,CAAjB;EACA,IAAMiD,OAAO,GAAGvB,MAAM,CAACwB,UAAP,CAAkB,IAAlB,CAAhB;EACAxB,MAAM,CAACM,KAAP,GAAeK,IAAI,CAACc,KAAL,CAAWJ,QAAQ,CAACf,KAAT,GAAiBY,WAA5B,CAAf;EACAlB,MAAM,CAACO,MAAP,GAAgBI,IAAI,CAACc,KAAL,CAAWJ,QAAQ,CAACd,MAAT,GAAkBW,WAA7B,CAAhB;EAEA,IAAMQ,SAAS,GAAGR,WAAW,KAAK,CAAhB,GACd,CAACA,WAAD,EAAc,CAAd,EAAiB,CAAjB,EAAoBA,WAApB,EAAiC,CAAjC,EAAoC,CAApC,CADc,GAEd,IAFJ;EAIA,IAAMS,aAAa,GAAG;IACpBC,aAAa,EAAEL,OADK;IAEpBG,SAAS,EAAEA,SAFS;IAGpBL,QAAQ,EAAEA;EAHU,CAAtB;EAZ4C,qBAiBtCX,IAAI,CAACM,MAAL,CAAYW,aAAZ,EAA2BE,OAjBW;AAkB7C,C,GAED;;;AA3JA,IAAMC,IAAI,GAAG;EACXC,cAAc,EAAE,wBAACC,CAAD;IAAA,OAAOA,CAAC,IAAI,MAAKrB,IAAI,CAACsB,EAAd,CAAR;EAAA,CADL;EAEXC,cAAc,EAAE,wBAACF,CAAD;IAAA,OAAOA,CAAC,IAAIrB,IAAI,CAACsB,EAAL,GAAQ,GAAZ,CAAR;EAAA,CAFL;EAGXE,QAAQ,EAAE,kBAACC,CAAD,EAAIC,CAAJ;IAAA,OAAU1B,IAAI,CAAC2B,KAAL,CAAWD,CAAC,CAACE,CAAF,GAAIH,CAAC,CAACG,CAAjB,EAAoBF,CAAC,CAAC1C,CAAF,GAAIyC,CAAC,CAACzC,CAA1B,CAAV;EAAA,CAHC;EAIX6C,MAAM,EAAG,gBAACJ,CAAD,EAAIC,CAAJ,EAAU;IAACD,CAAC,CAACzC,CAAF,GAAM0C,CAAC,CAAC1C,CAAR;IAAWyC,CAAC,CAACG,CAAF,GAAIF,CAAC,CAACE,CAAN;EAAQ,CAJ5B;EAKXE,GAAG,EAAG,aAACL,CAAD,EAAGC,CAAH;IAAA,OAAU;MAAE1C,CAAC,EAAEyC,CAAC,CAACzC,CAAF,GAAM0C,CAAC,CAAC1C,CAAb;MAAgB4C,CAAC,EAAEH,CAAC,CAACG,CAAF,GAAMF,CAAC,CAACE;IAA3B,CAAV;EAAA,CALK;EAMXG,QAAQ,EAAE,kBAACN,CAAD,EAAGC,CAAH;IAAA,OAAU;MAAE1C,CAAC,EAAEyC,CAAC,CAACzC,CAAF,GAAM0C,CAAC,CAAC1C,CAAb;MAAgB4C,CAAC,EAAEH,CAAC,CAACG,CAAF,GAAMF,CAAC,CAACE;IAA3B,CAAV;EAAA,CANC;EAOXI,cAAc,EAAE,wBAACP,CAAD,EAAI3F,CAAJ;IAAA,OAAW;MAAEkD,CAAC,EAAEyC,CAAC,CAACzC,CAAF,GAAMlD,CAAX;MAAc8F,CAAC,EAAEH,CAAC,CAACG,CAAF,GAAM9F;IAAvB,CAAX;EAAA,CAPL;EAQXmG,UAAU,EAAE,oBAACC,CAAD,EAAIT,CAAJ;IAAA,IAAOzC,CAAP,uEAAS,IAAT;IAAA,IAAe4C,CAAf,uEAAiB,IAAjB;IAAA,OAA2B;MAAC5C,CAAC,EAAGA,CAAC,KAAK,IAAP,GAAeA,CAAf,GAAmB,CAAC4C,CAAC,GAAGH,CAAC,CAACG,CAAP,IAAYM,CAAZ,GAAgBT,CAAC,CAACzC,CAAzC;MAA4C4C,CAAC,EAAGA,CAAC,KAAK,IAAP,GAAeA,CAAf,GAAmBM,CAAC,IAAIlD,CAAC,GAAGyC,CAAC,CAACzC,CAAV,CAAD,GAAgByC,CAAC,CAACG;IAApF,CAA3B;EAAA,CARD;EASXO,SAAS,EAAE,mBAAAV,CAAC;IAAA,OAAIzB,IAAI,CAACoC,IAAL,CAAWX,CAAC,CAACzC,CAAF,GAAMyC,CAAC,CAACzC,CAAT,GAAeyC,CAAC,CAACG,CAAF,GAAMH,CAAC,CAACG,CAAjC,CAAJ;EAAA,CATD;EAUXS,SAAS,EAAE,mBAAAZ,CAAC,EAAI;IACd,IAAMa,GAAG,GAAGnB,IAAI,CAACgB,SAAL,CAAeV,CAAf,CAAZ;IACA,OAAO;MAACzC,CAAC,EAAEyC,CAAC,CAACzC,CAAF,GAAMsD,GAAV;MAAeV,CAAC,EAAEH,CAAC,CAACG,CAAF,GAAMU;IAAxB,CAAP;EACD,CAbU;EAcXC,KAAK,EAAE,eAACd,CAAD,EAAsB;IAAA,IAAlBzF,CAAkB,uEAAf;MAACgD,CAAC,EAAC,CAAH;MAAM4C,CAAC,EAAC;IAAR,CAAe;IAC3B,IAAMY,CAAC,GAAGrB,IAAI,CAACY,QAAL,CAAcN,CAAd,EAAiBzF,CAAjB,CAAV;IACA,OAAOwG,CAAC,CAACZ,CAAF,GAAMY,CAAC,CAACxD,CAAf;EACD,CAjBU;EAkBXyD,kBAlBW,8BAkBQhB,CAlBR,EAkB0B;IAAA,IAAfzF,CAAe,uEAAX;MAACgD,CAAC,EAAC,CAAH;MAAM4C,CAAC,EAAC;IAAR,CAAW;IACnC,IAAMY,CAAC,GAAGrB,IAAI,CAACY,QAAL,CAAcN,CAAd,EAAiBzF,CAAjB,CAAV;IACA,OAAO,CAAEwG,CAAC,CAACxD,CAAJ,GAAQwD,CAAC,CAACZ,CAAjB;EACD,CArBU;EAsBXc,OAAO,EAAE,iBAACjB,CAAD,EAAGC,CAAH,EAAS;IAChB,IAAMiB,0BAA0B,GAAG,CAAElB,CAAC,CAACzC,CAAF,GAAM0C,CAAC,CAAC1C,CAAT,GAAeyC,CAAC,CAACG,CAAF,GAAMF,CAAC,CAACE,CAAxB,KAAgCF,CAAC,CAAC1C,CAAF,GAAM0C,CAAC,CAAC1C,CAAT,GAAe0C,CAAC,CAACE,CAAF,GAAMF,CAAC,CAACE,CAAtD,CAAnC;IACA,OAAM;MACJ5C,CAAC,EAAE0C,CAAC,CAAC1C,CAAF,GAAM2D,0BADL;MAEJf,CAAC,EAAEF,CAAC,CAACE,CAAF,GAAMe;IAFL,CAAN;EAID,CA5BU;EA8BXC,OAAO,EAAE,iBAACnB,CAAD,EAA4B;IAAA,IAAxBoB,GAAwB,uEAApB,CAAoB;IAAA,IAAjB7G,CAAiB,uEAAf;MAACgD,CAAC,EAAC,CAAH;MAAM4C,CAAC,EAAC;IAAR,CAAe;IACnC,IAAMY,CAAC,GAAGrB,IAAI,CAACY,QAAL,CAAcN,CAAd,EAAiBzF,CAAjB,CAAV;IACA,IAAMqF,CAAC,GAAGF,IAAI,CAACkB,SAAL,CAAeG,CAAf,CAAV;IACA,IAAM1D,EAAE,GAAGqC,IAAI,CAACa,cAAL,CAAoBX,CAApB,EAAuBwB,GAAvB,CAAX;IACA,OAAO1B,IAAI,CAACW,GAAL,CAAShD,EAAT,EAAa9C,CAAb,CAAP;EACD,CAnCU;EAoCX8G,aAAa,EAAE,uBAAA9D,CAAC;IAAA,OAAI,EAAEgB,IAAI,CAAC+C,GAAL,CAAS/C,IAAI,CAACsB,EAAL,GAAUtC,CAAnB,IAAwB,CAA1B,IAA+B,EAAnC;EAAA,CApCL;EAqCXgE,UAAU,EAAK,oBAAAhE,CAAC;IAAA,OAAI,IAAIgB,IAAI,CAAC+C,GAAL,CAAU/D,CAAC,GAAGgB,IAAI,CAACsB,EAAV,GAAgB,EAAzB,CAAR;EAAA,CArCL;EAsCX2B,WAAW,EAAI,qBAAAjE,CAAC;IAAA,OAAIgB,IAAI,CAACkD,GAAL,CAAUlE,CAAC,GAAGgB,IAAI,CAACsB,EAAV,GAAgB,EAAzB,CAAJ;EAAA;AAtCL,CAAb;;IAyCM6B,Q;EAOJ,oBAA2C;IAAA,IAA/BlE,SAA+B,uEAArB,GAAqB;IAAA,IAAhBmE,UAAgB,uEAAL,GAAK;;IAAA;;IAAA,kCANhC,EAMgC;;IAAA,+BALnC,CAAC,IAAD,CAKmC;;IAAA,mCAJ/B;MAACpE,CAAC,EAAC,CAAH;MAAK4C,CAAC,EAAC;IAAP,CAI+B;;IAAA,gCAHlC;MAAC5C,CAAC,EAAC,CAAH;MAAK4C,CAAC,EAAC;IAAP,CAGkC;;IAAA,8BAFpC,CAEoC;;IACzC,KAAK3C,SAAL,GAAiBA,SAAjB;IACA,KAAKmE,UAAL,GAAkBA,UAAlB;EACD;;;;WAED,wBAAeC,UAAf,EAA2B9D,IAA3B,EAAgC;MAC9B+D,QAAQ,CAACD,UAAD,CAAR,GAAuB9D,IAAvB;IACD;;;WAED,iBAAQM,GAAR,EAAa0D,MAAb,EAAoB;MAClB,IAAMC,WAAW,GAAG,KAAKhD,MAAM,CAACC,gBAAP,IAA2B,CAAhC,CAApB;MACA8C,MAAM,CAAC5F,KAAP,CAAa8F,GAAb,CAAiBD,WAAjB,EAA8BA,WAA9B;MACA,KAAKlF,KAAL,CAAWuB,GAAX,IAAkB0D,MAAlB;IACD;;;WAED,eAAMpE,CAAN,EAAQ;MACN;MACA,KAAKuE,SAAL,CAAe1E,CAAf,GAAoBG,CAAC,CAACH,CAAF,GAAM,CAAP,GAAY,CAAC,CAAb,GAAiB,CAApC;MACA,KAAK0E,SAAL,CAAe9B,CAAf,GAAoBzC,CAAC,CAACyC,CAAF,GAAM,CAAP,GAAY,CAAC,CAAb,GAAiB,CAApC;MAEA,KAAK+B,MAAL,GAAc;QACZ3E,CAAC,EAAE,KAAKC,SAAL,GAAiB,KAAKyE,SAAL,CAAe1E,CADvB;QAEZ4C,CAAC,EAAE,KAAKwB,UAAL,GAAkB,GAAlB,GAAwB,KAAKM,SAAL,CAAe9B;MAF9B,CAAd;IAID;;;WAED,cAAKzC,CAAL,EAAO;MACL,IAAM3B,EAAE,GAAG2D,IAAI,CAACY,QAAL,CAAc5C,CAAd,EAAiB,KAAKwE,MAAtB,CAAX;MACA,IAAMC,EAAE,GAAG,KAAK3E,SAAL,GAAiB,CAAC,KAAKyE,SAAL,CAAe1E,CAA5C;MACA,IAAM6E,EAAE,GAAG,KAAKT,UAAL,GAAkB,CAAC,KAAKM,SAAL,CAAe9B,CAA7C;;MAEA,4BAA6BuB,QAAQ,CAACW,aAAT,CAAuBtG,EAAvB,EAA2BqG,EAA3B,CAA7B;MAAA,IAAO/E,EAAP,yBAAOA,EAAP;MAAA,IAAWiF,EAAX,yBAAWA,EAAX;MAAA,IAAeC,EAAf,yBAAeA,EAAf;MAAA,IAAmBC,EAAnB,yBAAmBA,EAAnB;MAAA,IAAuBC,EAAvB,yBAAuBA,EAAvB,CALK,CAOL;;;MACA,IAAMC,GAAG,GAAIJ,EAAE,CAAC/E,CAAH,GAAO,CAAC,KAAK0E,SAAL,CAAe1E,CAApC;;MACA,IAAGmF,GAAG,GAAG,KAAKlF,SAAX,IAAwBkF,GAAG,GAAG,CAAjC,EAAmC;QACjCJ,EAAE,CAAC/E,CAAH,GAAO4E,EAAP;QAEA,IAAMQ,EAAE,GAAGjB,QAAQ,CAACW,aAAT,CAAuB3C,IAAI,CAACyB,OAAL,CAAapF,EAAb,EAAiB,KAAKyB,SAAtB,EAAiC8E,EAAjC,CAAvB,EAA6DF,EAA7D,CAAX;QACA1C,IAAI,CAACU,MAAL,CAAYrE,EAAZ,EAAgB4G,EAAE,CAAC5G,EAAnB;QACA2D,IAAI,CAACU,MAAL,CAAY/C,EAAZ,EAAgBsF,EAAE,CAACtF,EAAnB;QACAqC,IAAI,CAACU,MAAL,CAAYkC,EAAZ,EAAgBK,EAAE,CAACL,EAAnB;QACA5C,IAAI,CAACU,MAAL,CAAYmC,EAAZ,EAAgBI,EAAE,CAACJ,EAAnB;QACA7C,IAAI,CAACU,MAAL,CAAYoC,EAAZ,EAAgBG,EAAE,CAACH,EAAnB;QACA9C,IAAI,CAACU,MAAL,CAAYqC,EAAZ,EAAgBE,EAAE,CAACF,EAAnB;MACD;;MAED,IAAID,EAAE,CAACjF,CAAH,GAAO,CAAC,KAAK0E,SAAL,CAAe1E,CAAxB,GAA6B,KAAKC,SAArC,EAA+C;QAC7CgF,EAAE,CAACjF,CAAH,GAAO4E,EAAP;QAEAzC,IAAI,CAACU,MAAL,CAAYqC,EAAZ,EAAgB/C,IAAI,CAACyB,OAAL,CAAasB,EAAb,EAAiB,KAAKjF,SAAtB,EAAiCgF,EAAjC,CAAhB;QACA9C,IAAI,CAACU,MAAL,CAAYrE,EAAZ,EAAgB2D,IAAI,CAACyB,OAAL,CAAazB,IAAI,CAACc,UAAL,CAAgBd,IAAI,CAACsB,kBAAL,CAAwByB,EAAxB,EAA4BD,EAA5B,CAAhB,EAAiDC,EAAjD,EAAqD,CAArD,EAAwD,IAAxD,CAAb,EAA4E,KAAKd,UAAjF,EAA6Fc,EAA7F,CAAhB;QAEA,IAAMG,IAAI,GAAI7G,EAAE,CAACwB,CAAH,GAAO,CAAC,KAAK0E,SAAL,CAAe1E,CAArC;QACA,IAAMsF,SAAS,GAAG,EAAlB;;QACA,IAAGD,IAAI,GAAGC,SAAV,EAAqB;UACnB,IAAMC,KAAK,GAAGvE,IAAI,CAACwE,GAAL,CAASH,IAAI,GAAGC,SAAhB,EAA2B,CAA3B,CAAd;UACA9G,EAAE,CAACoE,CAAH,GAAOpE,EAAE,CAACoE,CAAH,GAAOT,IAAI,CAAC8B,WAAL,CAAiBsB,KAAjB,CAAd;QACD;;QAED,IAAMH,GAAE,GAAGjB,QAAQ,CAACW,aAAT,CAAuBtG,EAAvB,EAA2BqG,EAA3B,CAAX;;QACA1C,IAAI,CAACU,MAAL,CAAYrE,EAAZ,EAAgB4G,GAAE,CAAC5G,EAAnB;QACA2D,IAAI,CAACU,MAAL,CAAY/C,EAAZ,EAAgBsF,GAAE,CAACtF,EAAnB;QACAqC,IAAI,CAACU,MAAL,CAAYkC,EAAZ,EAAgBK,GAAE,CAACL,EAAnB;QACA5C,IAAI,CAACU,MAAL,CAAYmC,EAAZ,EAAgBI,GAAE,CAACJ,EAAnB;QACA7C,IAAI,CAACU,MAAL,CAAYoC,EAAZ,EAAgBG,GAAE,CAACH,EAAnB;QACA9C,IAAI,CAACU,MAAL,CAAYqC,EAAZ,EAAgBE,GAAE,CAACF,EAAnB;MACD;;MAED,OAAO;QAAC1G,EAAE,EAAFA,EAAD;QAAKsB,EAAE,EAAFA,EAAL;QAASiF,EAAE,EAAFA,EAAT;QAAaC,EAAE,EAAFA,EAAb;QAAiBC,EAAE,EAAFA,EAAjB;QAAqBC,EAAE,EAAFA;MAArB,CAAP;IACD;;;WAED,uBAAqB1G,EAArB,EAAyBiH,IAAzB,EAA+B;MAC7B,IAAM3F,EAAE,GAAGqC,IAAI,CAACa,cAAL,CAAoBxE,EAApB,EAAwB,EAAxB,CAAX;MAEA,IAAMkH,EAAE,GAAGvD,IAAI,CAACsB,kBAAL,CAAwB3D,EAAxB,CAAX;MACA,IAAMiF,EAAE,GAAG5C,IAAI,CAACc,UAAL,CAAgByC,EAAhB,EAAoB5F,EAApB,EAAwB,IAAxB,EAA8B,CAA9B,CAAX;MACA,IAAMkF,EAAE,GAAG7C,IAAI,CAACc,UAAL,CAAgByC,EAAhB,EAAoB5F,EAApB,EAAwB,CAAxB,EAA2B,IAA3B,CAAX;MACA,IAAMmF,EAAE,GAAG9C,IAAI,CAACc,UAAL,CAAgByC,EAAhB,EAAoB5F,EAApB,EAAwB,IAAxB,EAA8B2F,IAA9B,CAAX;MAEA,IAAMP,EAAE,GAAG/C,IAAI,CAACW,GAAL,CAASX,IAAI,CAACuB,OAAL,CAAavB,IAAI,CAACY,QAAL,CAAckC,EAAd,EAAkBzG,EAAlB,CAAb,EAAoC2D,IAAI,CAACY,QAAL,CAAciC,EAAd,EAAkBxG,EAAlB,CAApC,CAAT,EAAqEA,EAArE,CAAX;MACA,OAAO;QAAEA,EAAE,EAAFA,EAAF;QAAMsB,EAAE,EAAFA,EAAN;QAAUiF,EAAE,EAAFA,EAAV;QAAcC,EAAE,EAAFA,EAAd;QAAkBC,EAAE,EAAFA,EAAlB;QAAsBC,EAAE,EAAFA;MAAtB,CAAP;IACD;;;;;;IA0BGS,S;;;;;;;WACJ,mBAAiBC,QAAjB,EAA2BC,KAA3B,EAAkCC,IAAlC,EAAwCrD,CAAxC,EAAwD;MAAA,IAAbzF,CAAa,uEAAX;QAACgD,CAAC,EAAC,CAAH;QAAM4C,CAAC,EAAC;MAAR,CAAW;MACtD,IAAMmD,OAAO,GAAG5D,IAAI,CAACW,GAAL,CAAS9F,CAAT,EAAYyF,CAAZ,CAAhB;MAEAmD,QAAQ,CACLjG,SADH,CACakG,KADb,EAEGG,UAFH,CAEcD,OAAO,CAAC/F,CAFtB,EAEyB+F,OAAO,CAACnD,CAFjC,EAEoCkD,IAFpC,EAGGjG,OAHH;MAKA,OAAOkG,OAAP;IACD;;;WAED,kBAAgBH,QAAhB,EAA0BC,KAA1B,EAAiClF,KAAjC,EAAwCsF,KAAxC,EAA+CxD,CAA/C,EAAkDC,CAAlD,EAAoE;MAAA,IAAf1F,CAAe,uEAAX;QAACgD,CAAC,EAAC,CAAH;QAAM4C,CAAC,EAAC;MAAR,CAAW;MAClE,IAAMsD,EAAE,GAAG/D,IAAI,CAACW,GAAL,CAAS9F,CAAT,EAAYyF,CAAZ,CAAX;MACA,IAAM0D,EAAE,GAAGhE,IAAI,CAACW,GAAL,CAAS9F,CAAT,EAAY0F,CAAZ,CAAX;MAEAkD,QAAQ,CACLQ,SADH,CACa;QAAEzF,KAAK,EAALA,KAAF;QAASkF,KAAK,EAALA,KAAT;QAAgBI,KAAK,EAALA;MAAhB,CADb,EAEGI,MAFH,CAEUH,EAAE,CAAClG,CAFb,EAEgBkG,EAAE,CAACtD,CAFnB,EAGG0D,MAHH,CAGUH,EAAE,CAACnG,CAHb,EAGgBmG,EAAE,CAACvD,CAHnB,EAIG/C,OAJH;MAMA,OAAO;QAACqG,EAAE,EAAFA,EAAD;QAAKC,EAAE,EAAFA;MAAL,CAAP;IACD;;;;KAGH;;;AACA,WAAmG,YAAI;EACrG,IAAMI,SAAS,GAAGrF,QAAQ,CAACsF,cAAT,CAAwB,OAAxB,CAAlB;EACA,IAAMC,IAAI,GAAGF,SAAS,CAACG,qBAAV,EAAb;EACAC,OAAO,CAACC,GAAR,CAAYH,IAAZ;EACA,IAAMI,GAAG,GAAG,IAAI3H,IAAI,CAAC4H,WAAT,CAAqB;IAAEnG,KAAK,EAAE8F,IAAI,CAAC9F,KAAd;IAAqBC,MAAM,EAAE6F,IAAI,CAAC7F,MAAlC;IAA2CmG,SAAS,EAAE,KAAtD;IAA6DC,eAAe,EAAE,CAA9E;IAAiFC,eAAe,EAAE,QAAlG;IAA4GC,UAAU,EAAE;EAAxH,CAArB,CAAZ;EACAX,SAAS,CAACY,WAAV,CAAsBN,GAAG,CAACnI,IAA1B;EAEA,IAAM0I,WAAW,GAAG,IAAIlI,IAAI,CAACmI,SAAT,EAApB;EACAR,GAAG,CAAChJ,KAAJ,CAAU0B,QAAV,CAAmB6H,WAAnB;EACAA,WAAW,CAACpH,CAAZ,GAAgByG,IAAI,CAAC9F,KAAL,GAAa,EAA7B;EACAyG,WAAW,CAACxE,CAAZ,GAAgB6D,IAAI,CAAC7F,MAAL,GAAc,EAA9B;EAEA,IAAM0G,EAAE,GAAG,IAAIpI,IAAI,CAACqI,QAAT,EAAX;EACAD,EAAE,CAAC3H,SAAH,CAAa,QAAb;EACA2H,EAAE,CAAC1H,QAAH,CAAY,CAAC6G,IAAI,CAAC9F,KAAN,GAAc,EAA1B,EAA8B,CAAC8F,IAAI,CAAC7F,MAAN,GAAe,EAA7C,EAAiD6F,IAAI,CAAC9F,KAAtD,EAA6D8F,IAAI,CAAC7F,MAAlE;EACAwG,WAAW,CAAC7H,QAAZ,CAAqB+H,EAArB;EAEA,IAAM7H,SAAS,GAAG,IAAIP,IAAI,CAACqI,QAAT,EAAlB;EACAH,WAAW,CAAC7H,QAAZ,CAAqBE,SAArB;EAEA,IAAM+H,SAAS,GAAG,IAAItI,IAAI,CAACmI,SAAT,EAAlB;EACAD,WAAW,CAAC7H,QAAZ,CAAqBiI,SAArB;EAEA,IAAMlI,KAAK,GAAG,IAAIJ,IAAI,CAACmI,SAAT,EAAd;EACA/H,KAAK,CAACmI,IAAN,GAAahI,SAAb;EACA2H,WAAW,CAAC7H,QAAZ,CAAqBD,KAArB;EAEA,IAAMoI,YAAY,GAAG,IAAIxI,IAAI,CAACqI,QAAT,EAArB;EACAH,WAAW,CAAC7H,QAAZ,CAAqBmI,YAArB;EAEA,IAAMC,QAAQ,GAAG,IAAIzI,IAAI,CAACmI,SAAT,EAAjB;EACAM,QAAQ,CAACF,IAAT,GAAgBC,YAAhB;EACAN,WAAW,CAAC7H,QAAZ,CAAqBoI,QAArB;EAEA,IAAMC,iBAAiB,GAAG,IAAI1I,IAAI,CAACmI,SAAT,EAA1B;EACAM,QAAQ,CAACpI,QAAT,CAAkBqI,iBAAlB;EAEA,IAAM7I,IAAI,GAAG,IAAIG,IAAI,CAACqI,QAAT,EAAb;EACAxI,IAAI,CAAC8I,WAAL,GAAmB,IAAnB;EACAT,WAAW,CAAC7H,QAAZ,CAAqBR,IAArB;EAEA,IAAMC,KAAK,GAAG,IAAIE,IAAI,CAACqI,QAAT,EAAd;EACAH,WAAW,CAAC7H,QAAZ,CAAqBP,KAArB;EAEA,IAAM8I,GAAG,GAAG,IAAI5I,IAAI,CAACqI,QAAT,EAAZ;EACAH,WAAW,CAAC7H,QAAZ,CAAqBuI,GAArB;EAEAnC,SAAS,CAACoC,QAAV,CAAmBD,GAAnB,EAAwB,QAAxB,EAAkC,GAAlC,EAAuC,GAAvC,EAA4C;IAAC9H,CAAC,EAAC,CAAH;IAAM4C,CAAC,EAAC,CAACwE,WAAW,CAACxE;EAArB,CAA5C,EAAqE;IAAC5C,CAAC,EAAC,CAAH;IAAM4C,CAAC,EAAE6D,IAAI,CAAC7F;EAAd,CAArE;EACA+E,SAAS,CAACoC,QAAV,CAAmBD,GAAnB,EAAwB,QAAxB,EAAkC,GAAlC,EAAuC,GAAvC,EAA4C;IAAC9H,CAAC,EAAC,CAACoH,WAAW,CAACpH,CAAhB;IAAmB4C,CAAC,EAAC;EAArB,CAA5C,EAAqE;IAAC5C,CAAC,EAACyG,IAAI,CAAC9F,KAAR;IAAeiC,CAAC,EAAC;EAAjB,CAArE;EAEA,OAAO;IAAC0E,EAAE,EAAFA,EAAD;IAAKhI,KAAK,EAALA,KAAL;IAAYG,SAAS,EAATA,SAAZ;IAAuBkI,QAAQ,EAARA,QAAvB;IAAiCC,iBAAiB,EAAjBA,iBAAjC;IAAoDF,YAAY,EAAZA,YAApD;IAAkEF,SAAS,EAATA,SAAlE;IAA6EzI,IAAI,EAAJA,IAA7E;IAAmFC,KAAK,EAALA;EAAnF,CAAP;AACD,CAnDiG,EAAlG;AAAA,IAAOsI,EAAP,QAAOA,EAAP;AAAA,IAAWhI,KAAX,QAAWA,KAAX;AAAA,IAAkBG,SAAlB,QAAkBA,SAAlB;AAAA,IAA6BkI,QAA7B,QAA6BA,QAA7B;AAAA,IAAuCC,iBAAvC,QAAuCA,iBAAvC;AAAA,IAA0DF,YAA1D,QAA0DA,YAA1D;AAAA,IAAwEF,SAAxE,QAAwEA,SAAxE;AAAA,IAAmFzI,IAAnF,QAAmFA,IAAnF;AAAA,IAAyFC,KAAzF,QAAyFA,KAAzF;;AAqDA,SAASgJ,kBAAT,CAA4BnJ,IAA5B,EAAiC;EAC/B,IAAMoJ,OAAO,GAAIpJ,IAAI,CAAC6F,SAAL,CAAe1E,CAAf,GAAmB,CAApB,GAAwBnB,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAL,GAAU,CAArB,CAAxB,GAAkDlC,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAL,GAAU,CAArB,CAAlE;EACAkH,OAAO,CAACjI,CAAR,GAAY,CAAZ;EACAiI,OAAO,CAACrF,CAAR,GAAY,CAAZ;EACAgF,iBAAiB,CAAC5H,CAAlB,GAAuBnB,IAAI,CAAC6F,SAAL,CAAe1E,CAAf,GAAmB,CAApB,GAAyB,CAACnB,IAAI,CAACoB,SAA/B,GAA2C,CAAjE;EACA2H,iBAAiB,CAAChF,CAAlB,GAAuB/D,IAAI,CAAC6F,SAAL,CAAe9B,CAAf,GAAmB,CAApB,GAAyB,CAAC/D,IAAI,CAACuF,UAA/B,GAA4C,CAAlE;EACAwD,iBAAiB,CAACrI,QAAlB,CAA2B0I,OAA3B;AACD;;AAED,SAASnJ,QAAT,CAAkB6B,KAAlB,EAAyBC,MAAzB,EAAiC7B,IAAjC,EAAuCC,KAAvC,EAA6C;EAC3C,IAAMH,IAAI,GAAG,IAAIsF,QAAJ,CAAaxD,KAAb,EAAoBC,MAApB,CAAb;EACAY,MAAM,CAAC3C,IAAP,GAAcA,IAAd;EAEA,IAAIqJ,UAAU,GAAG,KAAjB;EACAnJ,IAAI,CAACqH,SAAL,CAAe;IAAEzF,KAAK,EAAE,CAAT;IAAYkF,KAAK,EAAE,QAAnB;IAA6BI,KAAK,EAAE;EAApC,CAAf;EACAlH,IAAI,CAACY,SAAL,CAAe,QAAf,EAAyB,IAAzB;EACAZ,IAAI,CAACa,QAAL,CAAc,CAACf,IAAI,CAACoB,SAApB,EAA+B,CAACpB,IAAI,CAACuF,UAAN,GAAmB,GAAlD,EAAuDvF,IAAI,CAACoB,SAAL,GAAiB,CAAxE,EAA2EpB,IAAI,CAACuF,UAAhF;EAEA9E,KAAK,CAACU,CAAN,GAAU,CAACW,KAAX;EACArB,KAAK,CAACsD,CAAN,GAAU,CAAChC,MAAD,GAAU,GAApB;EACA4G,SAAS,CAACxH,CAAV,GAAcV,KAAK,CAACU,CAApB;EACAwH,SAAS,CAAC5E,CAAV,GAActD,KAAK,CAACsD,CAApB;;EAEA,SAASuF,WAAT,CAAqBC,GAArB,EAAyB;IACvB,IAAMC,EAAE,GAAGD,GAAG,CAACE,IAAJ,CAASC,gBAAT,CAA0BjB,EAA1B,CAAX;IACAzI,IAAI,CAAC2J,KAAL,CAAWH,EAAX;;IAEA,IAAGxJ,IAAI,CAAC6F,SAAL,CAAe1E,CAAf,GAAmB,CAAtB,EAAwB;MACtB,IAAMyI,QAAQ,GAAG5J,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAL,GAAY,CAAvB,CAAjB;MACA,IAAG,CAAC0H,QAAJ,EAAa;MACbA,QAAQ,CAACzI,CAAT,GAAanB,IAAI,CAACoB,SAAlB;MACAuH,SAAS,CAACjI,QAAV,CAAmBkJ,QAAnB;IACD,CALD,MAKK;MACH,IAAMA,SAAQ,GAAG5J,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAL,GAAY,CAAvB,CAAjB;MACA,IAAG,CAAC0H,SAAJ,EAAa;MACbA,SAAQ,CAACzI,CAAT,GAAa,CAAb;MACAwH,SAAS,CAACjI,QAAV,CAAmBkJ,SAAnB;IACD;;IAEDP,UAAU,GAAG,IAAb;IACAF,kBAAkB,CAACnJ,IAAD,CAAlB;EACD;;EAED,SAAS6J,SAAT,GAAoB;IAClB,IAAGR,UAAU,KAAK,KAAlB,EAAwB;IAExBA,UAAU,GAAG,KAAb;;IACA,IAAGrJ,IAAI,CAAC6F,SAAL,CAAe1E,CAAf,GAAmB,CAAtB,EAAwB;MACtB;MACA;MACAwH,SAAS,CAACjI,QAAV,CAAmBV,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAhB,CAAnB,EAHsB,CAKtB;;MACAlC,IAAI,CAACkC,IAAL,IAAa,CAAb;IACD,CAPD,MAOK;MACH;MACAyG,SAAS,CAACmB,UAAV,CAAqB9J,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAhB,CAArB;MACAlC,IAAI,CAACkC,IAAL,IAAa,CAAb;IACD;;IAED,IAAM6H,WAAW,GAAG/J,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAhB,CAApB;IACA,IAAG6H,WAAH,EAAetJ,KAAK,CAACC,QAAN,CAAeqJ,WAAf;IACf,IAAMC,QAAQ,GAAGhK,IAAI,CAACS,KAAL,CAAWT,IAAI,CAACkC,IAAL,GAAU,CAArB,CAAjB;;IACA,IAAG8H,QAAH,EAAY;MACVvJ,KAAK,CAACC,QAAN,CAAesJ,QAAf;MACAA,QAAQ,CAAC7I,CAAT,GAAanB,IAAI,CAACoB,SAAlB;IACD;;IAEDyH,YAAY,CAAChI,KAAb;IACAD,SAAS,CAACC,KAAV;IACAV,KAAK,CAACU,KAAN;IACAD,SAAS,CAACE,SAAV,CAAoB,QAApB,EAA8B,CAA9B;IACAF,SAAS,CAACG,QAAV,CAAmB,CAACf,IAAI,CAACoB,SAAzB,EAAoC,CAACpB,IAAI,CAACuF,UAAN,GAAmB,EAAvD,EAA2DvF,IAAI,CAACoB,SAAL,GAAgB,CAA3E,EAA8EpB,IAAI,CAACuF,UAAnF;IACA3E,SAAS,CAACI,OAAV;EACD;;EAEDd,IAAI,CAAC+J,EAAL,CAAQ,aAAR,EAAuB,UAAAV,GAAG;IAAA,OAAID,WAAW,CAACC,GAAD,CAAf;EAAA,CAA1B,EACGU,EADH,CACM,WADN,EACmB;IAAA,OAAMJ,SAAS,EAAf;EAAA,CADnB,EAEGI,EAFH,CAEM,kBAFN,EAE0B;IAAA,OAAMJ,SAAS,EAAf;EAAA,CAF1B;EAIA3J,IAAI,CAAC+J,EAAL,CAAQ,aAAR,EAAuB,UAACV,GAAD,EAAO;IAC5B,IAAG,CAACF,UAAJ,EAAe;IACflJ,KAAK,CAACU,KAAN;IACAD,SAAS,CAACC,KAAV;IAEAgI,YAAY,CAAChI,KAAb;IAEA,IAAM2I,EAAE,GAAGD,GAAG,CAACE,IAAJ,CAASC,gBAAT,CAA0BjB,EAA1B,CAAX;;IACA,iBAAiCzI,IAAI,CAACkK,IAAL,CAAUV,EAAV,CAAjC;IAAA,IAAO7J,EAAP,cAAOA,EAAP;IAAA,IAAWsB,EAAX,cAAWA,EAAX;IAAA,IAAeiF,EAAf,cAAeA,EAAf;IAAA,IAAmBC,EAAnB,cAAmBA,EAAnB;IAAA,IAAuBC,EAAvB,cAAuBA,EAAvB;IAAA,IAA2BC,EAA3B,cAA2BA,EAA3B;;IACA,IAAM8D,MAAM,GAAGnK,IAAI,CAAC8F,MAApB;IAEAgB,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwCgK,MAAxC;IACA,IAAME,GAAG,GAAGvD,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwCR,EAAxC,EAA4CwK,MAA5C,CAAZ;IACA,IAAMG,GAAG,GAAGxD,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwCc,EAAxC,EAA4CkJ,MAA5C,CAAZ;IACA,IAAMI,GAAG,GAAGzD,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwC+F,EAAxC,EAA4CiE,MAA5C,CAAZ;IACA,IAAMK,GAAG,GAAG1D,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwCgG,EAAxC,EAA4CgE,MAA5C,CAAZ;IACA,IAAMM,GAAG,GAAG3D,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwCiG,EAAxC,EAA4C+D,MAA5C,CAAZ;IACA,IAAMO,GAAG,GAAG5D,SAAS,CAACsD,SAAV,CAAoBjK,KAApB,EAA2B,QAA3B,EAAqC,CAArC,EAAwCkG,EAAxC,EAA4C8D,MAA5C,CAAZ;IAEA,IAAMQ,GAAG,GAAI3K,IAAI,CAACoB,SAAL,GAAiB,CAAlB,GAAuB,CAACpB,IAAI,CAAC6F,SAAL,CAAe1E,CAAnD;IACA,IAAMyJ,GAAG,GAAG5K,IAAI,CAACuF,UAAL,GAAkB,CAACvF,IAAI,CAAC6F,SAAL,CAAe9B,CAA9C;IACA,IAAM8G,GAAG,GAAGvH,IAAI,CAACW,GAAL,CAAS;MAAC9C,CAAC,EAAEwJ,GAAJ;MAAS5G,CAAC,EAAE;IAAZ,CAAT,EAAyBoG,MAAzB,CAAZ;IACA,IAAMW,GAAG,GAAGxH,IAAI,CAACW,GAAL,CAAS;MAAC9C,CAAC,EAAEwJ,GAAJ;MAAU5G,CAAC,EAAE6G;IAAb,CAAT,EAA4BT,MAA5B,CAAZ;IACA,IAAMY,GAAG,GAAGzH,IAAI,CAACW,GAAL,CAAS;MAAC9C,CAAC,EAAE,CAAJ;MAAO4C,CAAC,EAAE6G;IAAV,CAAT,EAAyBT,MAAzB,CAAZ;IAEArB,QAAQ,CAACnF,QAAT,GAAoBL,IAAI,CAACK,QAAL,CAAc0G,GAAd,EAAmBE,GAAnB,KAA4BvK,IAAI,CAAC6F,SAAL,CAAe1E,CAAf,GAAmB,CAApB,GAAyB,CAAzB,GAA6BmC,IAAI,CAACI,cAAL,CAAoB,GAApB,CAAxD,CAApB;IACAoF,QAAQ,CAAC3H,CAAT,GAAakJ,GAAG,CAAClJ,CAAjB;IACA2H,QAAQ,CAAC/E,CAAT,GAAasG,GAAG,CAACtG,CAAjB;IAEA8E,YAAY,CACT/H,SADH,CACa,QADb,EACuB,CADvB,EAEGkK,WAFH,CAEgBb,MAAM,CAAChJ,CAAP,GAAW,CAAX,IAAgBiF,EAAE,CAACjF,CAAH,GAAO,CAAvB,IAA4BgJ,MAAM,CAAChJ,CAAP,GAAW,CAAX,IAAgBiF,EAAE,CAACjF,CAAH,GAAO,CAApD,GAAyD,CAACkJ,GAAD,EAAMG,GAAN,EAAWD,GAAX,CAAzD,GAA2E,CAACF,GAAD,EAAMK,GAAN,EAAWD,GAAX,EAAgBF,GAAhB,CAF1F,EAGGvJ,OAHH;IAKAJ,SAAS,CACNE,SADH,CACa,QADb,EACuB,CADvB,EAEGkK,WAFH,CAEgBb,MAAM,CAAChJ,CAAP,GAAW,CAAX,IAAgBiF,EAAE,CAACjF,CAAH,GAAO,CAAvB,IAA4BgJ,MAAM,CAAChJ,CAAP,GAAW,CAAX,IAAgBiF,EAAE,CAACjF,CAAH,GAAO,CAApD,GAAyD,CAAC0J,GAAD,EAAMC,GAAN,EAAWC,GAAX,EAAgBP,GAAhB,EAAqBD,GAArB,CAAzD,GAAqF,CAACM,GAAD,EAAMC,GAAN,EAAWL,GAAX,EAAgBF,GAAhB,CAFpG,EAGGvJ,OAHH;IAKAb,KAAK,CACFW,SADH,CACa,QADb,EACuB,GADvB,EAEE;IAFF,CAGGkK,WAHH,CAGgBb,MAAM,CAAChJ,CAAP,GAAW,CAAX,IAAgBiF,EAAE,CAACjF,CAAH,GAAO,CAAvB,IAA4BgJ,MAAM,CAAChJ,CAAP,GAAW,CAAX,IAAgBiF,EAAE,CAACjF,CAAH,GAAO,CAApD,GAAyD,CAACkJ,GAAD,EAAMG,GAAN,EAAWD,GAAX,CAAzD,GAA2E,CAACF,GAAD,EAAMK,GAAN,EAAWD,GAAX,EAAgBF,GAAhB,CAH1F,EAIGvJ,OAJH,GAvC4B,CA6C5B;;IACA8F,SAAS,CAACoC,QAAV,CAAmB/I,KAAnB,EAA0B,QAA1B,EAAoC,CAApC,EAAuC,GAAvC,EAA4CR,EAA5C,EAAgD;MAACwB,CAAC,EAAC,CAAH;MAAM4C,CAAC,EAAC;IAAR,CAAhD,EAA4DoG,MAA5D;IACArD,SAAS,CAACoC,QAAV,CAAmB/I,KAAnB,EAA0B,QAA1B,EAAoC,CAApC,EAAuC,GAAvC,EAA4Cc,EAA5C,EAAgDkF,EAAhD,EAAoDgE,MAApD;EACD,CAhDD;EAkDA,OAAOnK,IAAP;AACD;;AAGD,IAAMiL,GAAG,GAAGC,QAAQ,CAACC,WAAT,CAAqB,qBAArB,CAAZ;;AAUA,SAAS1J,OAAT,CAAiBD,MAAjB,EAAwB;EACtB,OAAO,IAAInE,OAAJ,CAAY,UAACC,OAAD,EAAUQ,MAAV,EAAoB;IACrC,IAAG;MACD0D,MAAM,CAAC4J,MAAP,CAAc,UAAC1J,IAAD,EAAQ;QACpBpE,OAAO,CAACoE,IAAD,CAAP;MACD,CAFD;IAGD,CAJD,CAIC,OAAO7D,CAAP,EAAS;MACRC,MAAM,CAACD,CAAD,CAAN;IACD;EACF,CARM,CAAP;AASD;;AAoDDoN,GAAG,CAAC5H,OAAJ,CAAYjG,IAAZ,CAAiB,UAAAmC,GAAG,EAAI;EACtB;EACA,IAAMC,CAAC,GAAGmD,MAAM,CAAC0I,UAAP,GAAoB,GAApB,GAA0B,GAApC;EACA,IAAM5L,CAAC,GAAGkD,MAAM,CAAC2I,WAAP,GAAqB,GAA/B;EACA3I,MAAM,CAACpD,GAAP,GAAaA,GAAb;EACAD,SAAS,CAACC,GAAD,EAAMC,CAAN,EAASC,CAAT,CAAT,CAAqBrC,IAArB,CAA0B,YAAI,CAAE,CAAhC;AACD,CAND"}